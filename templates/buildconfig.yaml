apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: bcbsfl-nginx-inline-build
  labels:
    app: bcbsfl-nginx-inline
spec:
  # --- SOURCE: INLINE DOCKERFILE, NO GIT ---
  source:
    type: Dockerfile
    dockerfile: |
      FROM nginx:1.27-alpine

      # Overwrite default nginx index.html with our custom message
      RUN printf '%s\n' \
        '<!DOCTYPE html>' \
        '<html>' \
        '  <head><title>BCBSFL Nginx Demo</title></head>' \
        '  <body><h1>welcome to bcbsfl</h1></body>' \
        '</html>' \
        > /usr/share/nginx/html/index.html

      EXPOSE 80

  # --- BUILD STRATEGY: DOCKER ---
  strategy:
    type: Docker
    dockerStrategy: {}

  # --- OUTPUT: PUSH IMAGE TO QUAY ---
  output:
    to:
      kind: DockerImage
      name: quay.io/bcbsfl/bcbsfl-nginx-inline:latest   # <--- change org/repo if needed
    pushSecret:
      name: quay-registry-secret                        # <--- must already exist in namespace

  # --- TRIGGERS ---
  triggers:
    - type: ConfigChange
